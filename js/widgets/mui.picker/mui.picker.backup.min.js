!function(l,n){var s=l.rad2deg=function(e){return e/(Math.PI/180)},e=(l.deg2rad=function(e){return e*(Math.PI/180)},navigator.platform.toLowerCase()),t=navigator.userAgent.toLowerCase(),i=(-1<t.indexOf("iphone")||-1<t.indexOf("ipad")||-1<t.indexOf("ipod"))&&(-1<e.indexOf("iphone")||-1<e.indexOf("ipad")||-1<e.indexOf("ipod")),r=l.Picker=function(e,t){var i=this;i.holder=e,i.options=t||{},i.init(),i.initInertiaParams(),i.calcElementItemPostion(!0),i.bindEvent()};r.prototype.findElementItems=function(){var e=this;return e.elementItems=[].slice.call(e.holder.querySelectorAll("li")),e.elementItems},r.prototype.init=function(){var e=this;e.list=e.holder.querySelector("ul"),e.findElementItems(),e.height=e.holder.offsetHeight,e.r=e.height/2-10,e.d=2*e.r,e.itemHeight=0<e.elementItems.length?e.elementItems[0].offsetHeight:40,e.itemAngle=parseInt(e.calcAngle(.8*e.itemHeight)),e.hightlightRange=e.itemAngle/2,e.visibleRange=90,e.beginAngle=0,e.beginExceed=e.beginAngle-30,e.list.angle=e.beginAngle,i&&(e.list.style.webkitTransformOrigin="center center "+e.r+"px")},r.prototype.calcElementItemPostion=function(n){var a=this;n&&(a.items=[]),a.elementItems.forEach(function(e){var t,i=a.elementItems.indexOf(e);a.endAngle=a.itemAngle*i,e.angle=a.endAngle,e.style.webkitTransformOrigin="center center -"+a.r+"px",e.style.webkitTransform="translateZ("+a.r+"px) rotateX("+-a.endAngle+"deg)",n&&((t={}).text=e.innerHTML||"",t.value=e.getAttribute("data-value")||t.text,a.items.push(t))}),a.endExceed=a.endAngle+30,a.calcElementItemVisibility(a.beginAngle)},r.prototype.calcAngle=function(e){var t=this,i=b=parseFloat(t.r);e=Math.abs(e);var n=180*parseInt(e/t.d);e%=t.d;var a=(i*i+b*b-e*e)/(2*i*b);return n+s(Math.acos(a))},r.prototype.calcElementItemVisibility=function(i){var n=this;n.elementItems.forEach(function(e){var t=Math.abs(e.angle-i);t<n.hightlightRange?e.classList.add("highlight"):t<n.visibleRange?(e.classList.add("visible"),e.classList.remove("highlight")):(e.classList.remove("highlight"),e.classList.remove("visible"))})},r.prototype.setAngle=function(e){var t=this;t.list.angle=e,t.list.style.webkitTransform="perspective(1000px) rotateY(0deg) rotateX("+e+"deg)",t.calcElementItemVisibility(e)},r.prototype.bindEvent=function(){var a=this,s=0,r=null,c=!1;a.holder.addEventListener(l.EVENT_START,function(e){c=!0,e.preventDefault(),a.list.style.webkitTransition="",r=(e.changedTouches?e.changedTouches[0]:e).pageY,s=a.list.angle,a.updateInertiaParams(e,!0)},!1),a.holder.addEventListener(l.EVENT_END,function(e){c=!1,e.preventDefault(),a.startInertiaScroll(e)},!1),a.holder.addEventListener(l.EVENT_CANCEL,function(e){c=!1,e.preventDefault(),a.startInertiaScroll(e)},!1),a.holder.addEventListener(l.EVENT_MOVE,function(e){var t,i,n;c&&(e.preventDefault(),t=(e.changedTouches?e.changedTouches[0]:e).pageY-r,i=a.calcAngle(t),(n=0<t?s-i:s+i)>a.endExceed&&(n=a.endExceed),n<a.beginExceed&&(n=a.beginExceed),a.setAngle(n),a.updateInertiaParams(e))},!1),a.list.addEventListener("tap",function(e){elementItem=e.target,"LI"==elementItem.tagName&&a.setSelectedIndex(a.elementItems.indexOf(elementItem),200)},!1)},r.prototype.initInertiaParams=function(){var e=this;e.lastMoveTime=0,e.lastMoveStart=0,e.stopInertiaMove=!1},r.prototype.updateInertiaParams=function(e,t){var i,n=this,a=e.changedTouches?e.changedTouches[0]:e;t?(n.lastMoveStart=a.pageY,n.lastMoveTime=e.timeStamp||Date.now(),n.startAngle=n.list.angle):300<(i=e.timeStamp||Date.now())-n.lastMoveTime&&(n.lastMoveTime=i,n.lastMoveStart=a.pageY),n.stopInertiaMove=!0},r.prototype.startInertiaScroll=function(e){var t=this,i=e.changedTouches?e.changedTouches[0]:e,n=e.timeStamp||Date.now(),a=(i.pageY-t.lastMoveStart)/(n-t.lastMoveTime),s=0<a?-1:1,r=6e-4*s*-1,c=Math.abs(a/r),l=a*c/2,o=t.list.angle,d=t.calcAngle(l)*s,u=d;o+d<t.beginExceed&&(c=c*((d=t.beginExceed-o)/u)*.6),o+d>t.endExceed&&(c=c*((d=t.endExceed-o)/u)*.6),0!=d?t.scrollDistAngle(n,o,d,c):t.endScroll()},r.prototype.scrollDistAngle=function(e,t,i,n){var a,s,r,c,l=this;l.stopInertiaMove=!1,a=t,s=i,r=n/13,c=0,function e(){var t;l.stopInertiaMove||(t=l.quartEaseOut(c,a,s,r),l.setAngle(t),r-1<++c||t<l.beginExceed||t>l.endExceed?l.endScroll():setTimeout(e,13))}()},r.prototype.quartEaseOut=function(e,t,i,n){return-i*((e=e/n-1)*e*e*e-1)+t},r.prototype.endScroll=function(){var e,t=this;t.list.angle<t.beginAngle?(t.list.style.webkitTransition="150ms ease-out",t.setAngle(t.beginAngle)):t.list.angle>t.endAngle?(t.list.style.webkitTransition="150ms ease-out",t.setAngle(t.endAngle)):(e=parseInt((t.list.angle/t.itemAngle).toFixed(0)),t.list.style.webkitTransition="100ms ease-out",t.setAngle(t.itemAngle*e)),t.triggerChange()},r.prototype.triggerChange=function(i){var n=this;setTimeout(function(){var e=n.getSelectedIndex(),t=n.items[e];!l.trigger||e==n.lastIndex&&!0!==i||l.trigger(n.holder,"change",{index:e,item:t}),n.lastIndex=e,"function"==typeof i&&i()},0)},r.prototype.correctAngle=function(e){return e<this.beginAngle?this.beginAngle:e>this.endAngle?this.endAngle:e},r.prototype.setItems=function(e){var t=this;t.items=e||[];var i=[];t.items.forEach(function(e){null!==e&&e!==n&&i.push("<li>"+(e.text||e)+"</li>")}),t.list.innerHTML=i.join(""),t.findElementItems(),t.calcElementItemPostion(),t.setAngle(t.correctAngle(t.list.angle)),t.triggerChange(!0)},r.prototype.getItems=function(){return this.items},r.prototype.getSelectedIndex=function(){return parseInt((this.list.angle/this.itemAngle).toFixed(0))},r.prototype.setSelectedIndex=function(e,t,i){var n=this;n.list.style.webkitTransition="";var a,s=n.correctAngle(n.itemAngle*e);t&&0<t?(a=s-n.list.angle,n.scrollDistAngle(Date.now(),n.list.angle,a,t)):n.setAngle(s),n.triggerChange(i)},r.prototype.getSelectedItem=function(){return this.items[this.getSelectedIndex()]},r.prototype.getSelectedValue=function(){return(this.items[this.getSelectedIndex()]||{}).value},r.prototype.getSelectedText=function(){return(this.items[this.getSelectedIndex()]||{}).text},r.prototype.setSelectedValue=function(e,t,i){for(var n in this.items){if(this.items[n].value==e)return void this.setSelectedIndex(n,t,i)}},l.fn&&(l.fn.picker=function(a){return this.each(function(e,t){var i,n;t.picker||(a?t.picker=new r(t,a):(n=(i=t.getAttribute("data-picker-options"))?JSON.parse(i):{},t.picker=new r(t,n)))}),this[0]?this[0].picker:null},l.ready(function(){l(".mui-picker").picker()}))}(window.mui||window,(window,void document)),function(s,i){s.dom=function(e){return"string"!=typeof e?e instanceof Array||e[0]&&e.length?[].slice.call(e):[e]:(s.__create_dom_div__||(s.__create_dom_div__=i.createElement("div")),s.__create_dom_div__.innerHTML=e,[].slice.call(s.__create_dom_div__.childNodes))};s.PopPicker=s.Class.extend({init:function(e){var t=this;t.options=e||{},t.options.buttons=t.options.buttons||["取消","确定"],t.panel=s.dom('<div class="mui-poppicker">\t\t<div class="mui-poppicker-header">\t\t\t<button class="mui-btn mui-poppicker-btn-cancel">取消</button>\t\t\t<button class="mui-btn mui-btn-blue mui-poppicker-btn-ok">确定</button>\t\t\t<div class="mui-poppicker-clear"></div>\t\t</div>\t\t<div class="mui-poppicker-body">\t\t</div>\t</div>')[0],i.body.appendChild(t.panel),t.ok=t.panel.querySelector(".mui-poppicker-btn-ok"),t.cancel=t.panel.querySelector(".mui-poppicker-btn-cancel"),t.body=t.panel.querySelector(".mui-poppicker-body"),t.mask=s.createMask(),t.cancel.innerText=t.options.buttons[0],t.ok.innerText=t.options.buttons[1],t.cancel.addEventListener("tap",function(e){t.hide()},!1),t.ok.addEventListener("tap",function(e){t.callback&&!1!==t.callback(t.getSelectedItems())&&t.hide()},!1),t.mask[0].addEventListener("tap",function(){t.hide()},!1),t._createPicker(),t.panel.addEventListener(s.EVENT_START,function(e){e.preventDefault()},!1),t.panel.addEventListener(s.EVENT_MOVE,function(e){e.preventDefault()},!1)},_createPicker:function(){var e=this.options.layer||1,t=100/e+"%";this.pickers=[];for(var i=1;i<=e;i++){var n=s.dom('<div class="mui-picker">\t\t<div class="mui-picker-inner">\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t<ul class="mui-pciker-list">\t\t\t</ul>\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t</div>\t</div>')[0];n.style.width=t,this.body.appendChild(n);var a=s(n).picker();this.pickers.push(a),n.addEventListener("change",function(e){var t,i=this.nextSibling;i&&i.picker&&(t=(e.detail||{}).item||{},i.picker.setItems(t.children))},!1)}},setData:function(e){e=e||[],this.pickers[0].setItems(e)},getSelectedItems:function(){var e=[];for(var t in this.pickers){var i=this.pickers[t];e.push(i.getSelectedItem()||{})}return e},show:function(e){var t=this;t.callback=e,t.mask.show(),i.body.classList.add(s.className("poppicker-active-for-page")),t.panel.classList.add(s.className("active")),t.__back=s.back,s.back=function(){t.hide()}},hide:function(){this.disposed||(this.panel.classList.remove(s.className("active")),this.mask.close(),i.body.classList.remove(s.className("poppicker-active-for-page")),s.back=this.__back)},dispose:function(){var t=this;t.hide(),setTimeout(function(){for(var e in t.panel.parentNode.removeChild(t.panel),t)t[e]=null,delete t[e];t.disposed=!0},300)}})}(mui,document),function(a,s){a.dom=function(e){return"string"!=typeof e?e instanceof Array||e[0]&&e.length?[].slice.call(e):[e]:(a.__create_dom_div__||(a.__create_dom_div__=s.createElement("div")),a.__create_dom_div__.innerHTML=e,[].slice.call(a.__create_dom_div__.childNodes))};a.DtPicker=a.Class.extend({init:function(e){var t=this,i=a.dom('<div class="mui-dtpicker" data-type="datetime">\t\t<div class="mui-dtpicker-header">\t\t\t<button data-id="btn-cancel" class="mui-btn">取消</button>\t\t\t<button data-id="btn-ok" class="mui-btn mui-btn-blue">确定</button>\t\t</div>\t\t<div class="mui-dtpicker-title"><h5 data-id="title-y">年</h5><h5 data-id="title-m">月</h5><h5 data-id="title-d">日</h5><h5 data-id="title-h">时</h5><h5 data-id="title-i">分</h5></div>\t\t<div class="mui-dtpicker-body">\t\t\t<div data-id="picker-y" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-m" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-d" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-h" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-i" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t</div>\t</div>')[0];s.body.appendChild(i),a('[data-id*="picker"]',i).picker();var n=t.ui={picker:i,mask:a.createMask(),ok:a('[data-id="btn-ok"]',i)[0],cancel:a('[data-id="btn-cancel"]',i)[0],y:a('[data-id="picker-y"]',i)[0],m:a('[data-id="picker-m"]',i)[0],d:a('[data-id="picker-d"]',i)[0],h:a('[data-id="picker-h"]',i)[0],i:a('[data-id="picker-i"]',i)[0],labels:a('[data-id*="title-"]',i)};n.cancel.addEventListener("tap",function(){t.hide()},!1),n.ok.addEventListener("tap",function(){!1!==t.callback(t.getSelected())&&t.hide()},!1),n.y.addEventListener("change",function(e){t.options.beginMonth||t.options.endMonth?t._createMonth():t._createDay()},!1),n.m.addEventListener("change",function(e){t._createDay()},!1),n.d.addEventListener("change",function(e){(t.options.beginMonth||t.options.endMonth)&&t._createHours()},!1),n.h.addEventListener("change",function(e){(t.options.beginMonth||t.options.endMonth)&&t._createMinutes()},!1),n.mask[0].addEventListener("tap",function(){t.hide()},!1),t._create(e),t.ui.picker.addEventListener(a.EVENT_START,function(e){e.preventDefault()},!1),t.ui.picker.addEventListener(a.EVENT_MOVE,function(e){e.preventDefault()},!1)},getSelected:function(){var e=this.ui,t=this.options.type,i={type:t,y:e.y.picker.getSelectedItem(),m:e.m.picker.getSelectedItem(),d:e.d.picker.getSelectedItem(),h:e.h.picker.getSelectedItem(),i:e.i.picker.getSelectedItem(),toString:function(){return this.value}};switch(t){case"datetime":i.value=i.y.value+"-"+i.m.value+"-"+i.d.value+" "+i.h.value+":"+i.i.value,i.text=i.y.text+"-"+i.m.text+"-"+i.d.text+" "+i.h.text+":"+i.i.text;break;case"date":i.value=i.y.value+"-"+i.m.value+"-"+i.d.value,i.text=i.y.text+"-"+i.m.text+"-"+i.d.text;break;case"time":i.value=i.h.value+":"+i.i.value,i.text=i.h.text+":"+i.i.text;break;case"month":i.value=i.y.value+"-"+i.m.value,i.text=i.y.text+"-"+i.m.text;break;case"hour":i.value=i.y.value+"-"+i.m.value+"-"+i.d.value+" "+i.h.value,i.text=i.y.text+"-"+i.m.text+"-"+i.d.text+" "+i.h.text}return i},setSelectedValue:function(e){var t=this.ui,i=this._parseValue(e);t.y.picker.setSelectedValue(i.y,0,function(){t.m.picker.setSelectedValue(i.m,0,function(){t.d.picker.setSelectedValue(i.d,0,function(){t.h.picker.setSelectedValue(i.h,0,function(){t.i.picker.setSelectedValue(i.i,0)})})})})},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},_inArray:function(e,t){for(var i in e){if(e[i]===t)return!0}return!1},getDayNum:function(e,t){return this._inArray([1,3,5,7,8,10,12],t)?31:this._inArray([4,6,9,11],t)?30:this.isLeapYear(e)?29:28},_fill:function(e){return(e=e.toString()).length<2&&(e=0+e),e},_isBeginYear:function(){return this.options.beginYear===parseInt(this.ui.y.picker.getSelectedValue())},_isBeginMonth:function(){return this.options.beginMonth&&this._isBeginYear()&&this.options.beginMonth===parseInt(this.ui.m.picker.getSelectedValue())},_isBeginDay:function(){return this._isBeginMonth()&&this.options.beginDay===parseInt(this.ui.d.picker.getSelectedValue())},_isBeginHours:function(){return this._isBeginDay()&&this.options.beginHours===parseInt(this.ui.h.picker.getSelectedValue())},_isEndYear:function(){return this.options.endYear===parseInt(this.ui.y.picker.getSelectedValue())},_isEndMonth:function(){return this.options.endMonth&&this._isEndYear()&&this.options.endMonth===parseInt(this.ui.m.picker.getSelectedValue())},_isEndDay:function(){return this._isEndMonth()&&this.options.endDay===parseInt(this.ui.d.picker.getSelectedValue())},_isEndHours:function(){return this._isEndDay()&&this.options.endHours===parseInt(this.ui.h.picker.getSelectedValue())},_createYear:function(e){var t=this.options,i=this.ui,n=[];if(t.customData.y)n=t.customData.y;else for(var a=t.beginYear,s=t.endYear,r=a;r<=s;r++)n.push({text:r+"",value:r});i.y.picker.setItems(n)},_createMonth:function(e){var t=this,i=t.options,n=t.ui,a=[];if(i.customData.m)a=i.customData.m;else for(var s=i.beginMonth&&t._isBeginYear()?i.beginMonth:1,r=i.endMonth&&t._isEndYear()?i.endMonth:12;s<=r;s++){var c=t._fill(s);a.push({text:c,value:c})}n.m.picker.setItems(a)},_createDay:function(e){var t=this,i=t.options,n=t.ui,a=[];if(i.customData.d)a=i.customData.d;else for(var s=t._isBeginMonth()?i.beginDay:1,r=t._isEndMonth()?i.endDay:t.getDayNum(parseInt(this.ui.y.picker.getSelectedValue()),parseInt(this.ui.m.picker.getSelectedValue()));s<=r;s++){var c=t._fill(s);a.push({text:c,value:c})}n.d.picker.setItems(a),e=e||n.d.picker.getSelectedValue()},_createHours:function(e){var t=this,i=t.options,n=t.ui,a=[];if(i.customData.h)a=i.customData.h;else for(var s=t._isBeginDay()?i.beginHours:0,r=t._isEndDay()?i.endHours:23;s<=r;s++){var c=t._fill(s);a.push({text:c,value:c})}n.h.picker.setItems(a)},_createMinutes:function(e){var t=this,i=t.options,n=t.ui,a=[];if(i.customData.i)a=i.customData.i;else for(var s=t._isBeginHours()?i.beginMinutes:0,r=t._isEndHours()?i.endMinutes:59;s<=r;s++){var c=t._fill(s);a.push({text:c,value:c})}n.i.picker.setItems(a)},_setLabels:function(){var i=this.options;this.ui.labels.each(function(e,t){t.innerText=i.labels[e]})},_setButtons:function(){var e=this.options,t=this.ui;t.cancel.innerText=e.buttons[0],t.ok.innerText=e.buttons[1]},_parseValue:function(e){var t,i,n={};return e?(t=e.replace(":","-").replace(" ","-").split("-"),n.y=t[0],n.m=t[1],n.d=t[2],n.h=t[3],n.i=t[4]):(i=new Date,n.y=i.getFullYear(),n.m=i.getMonth()+1,n.d=i.getDate(),n.h=i.getHours(),n.i=i.getMinutes()),n},_create:function(e){var t=this;(e=e||{}).labels=e.labels||["年","月","日","时","分"],e.buttons=e.buttons||["取消","确定"],e.type=e.type||"datetime",e.customData=e.customData||{},t.options=e;var i=new Date,n=e.beginDate;n instanceof Date&&!isNaN(n.valueOf())&&(e.beginYear=n.getFullYear(),e.beginMonth=n.getMonth()+1,e.beginDay=n.getDate(),e.beginHours=n.getHours(),e.beginMinutes=n.getMinutes());var a=e.endDate;a instanceof Date&&!isNaN(a.valueOf())&&(e.endYear=a.getFullYear(),e.endMonth=a.getMonth()+1,e.endDay=a.getDate(),e.endHours=a.getHours(),e.endMinutes=a.getMinutes()),e.beginYear=e.beginYear||i.getFullYear()-5,e.endYear=e.endYear||i.getFullYear()+5;var s=t.ui;t._setLabels(),t._setButtons(),s.picker.setAttribute("data-type",e.type),t._createYear(),t._createMonth(),t._createDay(),t._createHours(),t._createMinutes(),t.setSelectedValue(e.value)},show:function(e){var t=this,i=t.ui;t.callback=e||a.noop,i.mask.show(),s.body.classList.add(a.className("dtpicker-active-for-page")),i.picker.classList.add(a.className("active")),t.__back=a.back,a.back=function(){t.hide()}},hide:function(){var e;this.disposed||((e=this.ui).picker.classList.remove(a.className("active")),e.mask.close(),s.body.classList.remove(a.className("dtpicker-active-for-page")),a.back=this.__back)},dispose:function(){var t=this;t.hide(),setTimeout(function(){for(var e in t.ui.picker.parentNode.removeChild(t.ui.picker),t)t[e]=null,delete t[e];t.disposed=!0},300)}})}(mui,document);