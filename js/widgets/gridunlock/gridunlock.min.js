!function(t,a){"use strict";var c={r:26,cw:t.body.offsetWidth,ch:320,offsetX:15,offsetY:15,outRoundBorderColor:"#666",lineWidth:"7",lineColor:"#f00",outRoundColor:"#fff",innerRoundColor:"#008080",itemClick:function(t){}};function f(t){var o=this,e=[{key:t.container,value:"请传入canvas元素id"}];o.environment(e),o.container=a.selector(t.container),console.log(o),(o=a.extend({},c,t,o)).__proto__=f.prototype;var n=o.container,r=n.getContext("2d");n.width=o.cw,n.height=o.ch,o.offsetTop=n.offsetTop;var i=(o.cw-2*o.offsetX-2*o.r*3)/2,l=(o.ch-2*o.offsetY-2*o.r*3)/2;o.pointArr=o._drawLocalPoint(i,l),o._initListeners(n,r,t.itemClick),o._draw(o.pointArr,[],null,r)}f.prototype={_drawLocalPoint:function(t,o){for(var e=[],n=this,r=n.offsetX,i=n.offsetY,l=n.r,a=0;a<3;a++)for(var c=0;c<3;c++){var f={x:r+c*t+(2*c+1)*l,y:i+a*o+(2*a+1)*l};e.push(f)}return e},environment:function(t){for(var o=0,e=t.length;o<e;o++)if(!t[o].key)throw new Error(t[o].value)},_initListeners:function(t,e,o){var n=[],r=this;t.addEventListener("touchstart",function(t){r._selectPoint(t.touches[0],n)}),t.addEventListener("touchmove",function(t){t.preventDefault();var o=t.touches[0];r._selectPoint(o,n),e.clearRect(0,0,r.cw,r.ch),r._draw(r.pointArr,n,{x:o.pageX,y:o.pageY-r.offsetTop},e)}),t.addEventListener("touchend",function(t){e.clearRect(0,0,r.cw,r.ch),r._draw(r.pointArr,n,null,e),o.call(r,n),n=[]})},_selectPoint:function(t,o){for(var e=this.pointArr,n=0,r=e.length;n<r;n++){var i=e[n],l=Math.abs(i.x-t.pageX),a=Math.abs(i.y-(t.pageY-this.offsetTop));if(Math.pow(l*l+a*a,.5)<this.r){o.indexOf(n)<0&&o.push(n);break}}},_draw:function(t,o,e,n){var r=this,i=r.r,l=2*Math.PI;if(0<o.length){n.beginPath();for(var a,c=0,f=o.length;c<f;c++){var s=o[c];n.lineTo(t[s].x,t[s].y)}n.lineWidth=r.lineWidth,n.strokeStyle=r.lineColor,n.stroke(),n.closePath(),null!=e&&(a=t[o[o.length-1]],n.beginPath(),n.moveTo(a.x,a.y),n.lineTo(e.x,e.y),n.stroke(),n.closePath())}for(c=0,f=t.length;c<f;c++){var h=t[c];n.fillStyle=r.outRoundBorderColor,n.beginPath(),n.arc(h.x,h.y,i,0,l,!0),n.closePath(),n.fill(),n.fillStyle=r.outRoundColor,n.beginPath(),n.arc(h.x,h.y,i-3,0,l,!0),n.closePath(),n.fill(),0<=o.indexOf(c)&&(n.fillStyle=r.innerRoundColor,n.beginPath(),n.arc(h.x,h.y,i-16,0,l,!0),n.closePath(),n.fill())}}},window.GridUnlock=f}(document,window.Util);