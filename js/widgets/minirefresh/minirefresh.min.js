!function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):o.MiniRefreshTools=t()}(this,function(){"use strict";function o(){}function c(o){return Array.isArray?Array.isArray(o):o instanceof Array}function i(o){var t=Object.prototype.toString.call(o).match(/^\[object\s(.*)\]$/)[1];return"String"!==t&&"Number"!==t&&"Boolean"!==t&&"Undefined"!==t&&"Null"!==t}function t(o){return o&&o===window}function p(o){return i(o)&&!t(o)&&Object.getPrototypeOf(o)===Object.prototype}function h(){var o=arguments,t=arguments.length,a=(arguments.length<=0?void 0:arguments[0])||{},n=1,l=!1;"boolean"==typeof a&&(l=a,a=(arguments.length<=n?void 0:arguments[n])||{},n++),i(a)||(a={});for(;n<t;n++)!function(){var r=o.length<=n?void 0:o[n];r&&i(r)&&Object.keys(r).forEach(function(o){var t=a[o],n=r[o],i=p(n),s=c(n),e=void 0;a!==n&&(l&&n&&(s||i)?(e=s?(s=!1,t&&c(t)?t:[]):t&&p(t)?t:{},a[o]=h(l,e,n)):void 0!==n&&(a[o]=n))})}();return a}function n(o){var t=o;return"string"==typeof t&&(t=document.querySelector(t)),t}function u(o){var t=o.clientHeight;return o===document.body&&"CSS1Compat"===document.compatMode&&(t=document.documentElement.clientHeight),t}function s(o,t,n){if(!t)return o;for(var i=t.split("."),s=i.length,e=o,r=0;r<s-1;r+=1){var a=i[r];e[a]=e[a]||{},e=e[a]}return e[i[s-1]]=n}var e=Object.freeze({getNow:function(){return window.performance&&(window.performance.now?window.performance.now()+window.performance.timing.navigationStart:+new Date)},noop:o,isArray:c,isObject:i,isWindow:t,isPlainObject:p,extend:h,selector:n,getClientHeightByDom:u,namespace:s});var d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(o){return window.setTimeout(o,(o.interval||1e3/60)/2)};function r(o,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}var a="initScroll",l="scroll",w="pull",f="upLoading",g="resetUpLoading",v="downLoading",L="cancelLoading",k="beforeDownLoading",m=(function(o,t,n){return t&&r(o.prototype,t),n&&r(o,n),o}(y,[{key:"_init",value:function(){var o=this;this._initPullDown(),this._initPullUp(),setTimeout(function(){o.options.down&&o.options.down.isAuto&&!o.options.down.isLock?o.options.down.isAllowAutoLoading?o.triggerDownLoading():o.events[v]&&o.events[v](!0):o.options.up&&o.options.up.isAuto&&!o.options.up.isLock&&o.triggerUpLoading(),o.events[a]&&o.events[a]()})}},{key:"refreshOptions",value:function(o){this.options=o}},{key:"translateContentWrap",value:function(o,t){var n,i=o||0,s=t||0;this.downHight=i,this.options.down.isScrollCssTranslate&&((n=this.contentWrap).style.webkitTransitionDuration=s+"ms",n.style.transitionDuration=s+"ms",n.style.webkitTransform="translate(0px, "+i+"px) translateZ(0px)",n.style.transform="translate(0px, "+i+"px) translateZ(0px)")}},{key:"_scrollWrapAnimation",value:function(){this.scrollWrap.webkitTransitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)",this.scrollWrap.transitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)"}},{key:"_initPullDown",value:function(){var p=this,h=this.scrollWrap,u=document.documentElement.clientHeight;function o(o){p.isScrollTo&&o.preventDefault(),p.startTop=h.scrollTop,p.startY=o.touches?o.touches[0].pageY:o.clientY,p.startX=o.touches?o.touches[0].pageX:o.clientX}function d(){var o=p.options;p.isMoveDown&&(p.downHight>=o.down.offset?p.triggerDownLoading():(p.translateContentWrap(0,o.down.bounceTime),p.events[L]&&p.events[L]()),p.isMoveDown=!1),p.startY=0,p.startX=0,p.preY=0,p.startTop=void 0,p.isBounce=!1}function t(o){var t=p.options,n=!0;if((p.downLoading||!t.down.isAways&&p.upLoading)&&(n=!1),void 0!==p.startTop&&p.startTop<=0&&n&&!p.options.down.isLock){var i=o.touches?o.touches[0].pageY:o.clientY,s=o.touches?o.touches[0].pageX:o.clientX;if(u<i)return void d();p.preY||(p.preY=i);var e,r,a=i-p.preY,l=(p.preY=i)-p.startY,c=s-p.startX;if(t.isLockX&&Math.abs(c)>Math.abs(l))return void o.preventDefault();if(p.isBounce&&p.os.ios)return;0<l?(p.isMoveDown=!0,o.preventDefault(),p.downHight||(p.downHight=0),e=t.down.offset,r=1,r=p.downHight<e?t.down.dampRateBegin:t.down.dampRate,p.downHight+=0<a?a*r:a,p.events[w]&&p.events[w](p.downHight,e),p.translateContentWrap(p.downHight)):(p.isBounce=!0,h.scrollTop<=0&&(h.scrollTop+=Math.abs(a)))}}this._scrollWrapAnimation(),h.addEventListener("touchstart",o),h.addEventListener("mousedown",o),h.addEventListener("touchend",d),h.addEventListener("mouseup",d),h.addEventListener("mouseleave",d),h.addEventListener("touchmove",t),h.addEventListener("mousemove",t)}},{key:"_initPullUp",value:function(){var e=this,r=this.scrollWrap;(r===document.body?window:r).addEventListener("scroll",function(){var o=r.scrollTop,t=r.scrollHeight,n=u(r),i=e.options;e.events[l]&&e.events[l](o);var s=!0;(e.upLoading||!i.down.isAways&&e.downLoading)&&(s=!1),s&&!e.options.up.isLock&&!e.isFinishUp&&0<t&&t-n-o<=i.up.offset&&e.triggerUpLoading()})}},{key:"_loadFull",value:function(){var o=this,t=this.scrollWrap,n=this.options;setTimeout(function(){!o.options.up.isLock&&n.up.loadFull.isEnable&&0===t.scrollTop&&0<t.scrollHeight&&t.scrollHeight<=u(t)&&o.triggerUpLoading()},n.up.loadFull.delay||0)}},{key:"triggerDownLoading",value:function(o){var t=this.options;this.hooks[k]&&!this.hooks[k](this.downHight,t.down.offset)||(this.downLoading=!0,o&&"noAnim"==o?(this.translateContentWrap(0),this.endDownLoading(),this.events[v]&&this.events[v](!0)):(this.translateContentWrap(t.down.offset,t.down.bounceTime),this.events[v]&&this.events[v]()))}},{key:"endDownLoading",value:function(){var o=this.options;this.downLoading&&(this.translateContentWrap(0,o.down.bounceTime),this.downLoading=!1)}},{key:"triggerUpLoading",value:function(){this.upLoading=!0,this.events[f]&&this.events[f]()}},{key:"endUpLoading",value:function(o){this.upLoading&&(this.upLoading=!1,o?this.isFinishUp=!0:this._loadFull())}},{key:"resetUpLoading",value:function(){this.isFinishUp&&(this.isFinishUp=!1),this._loadFull(),this.events[g]&&this.events[g]()}},{key:"scrollTo",value:function(o,t){var n=this,i=this.scrollWrap,s=t||0,e=i.scrollHeight-u(i),r=o||0,r=Math.max(r,0);r=Math.min(r,e);var a,l,c,p=i.scrollTop-r;0!=p&&0!==s?(a=Math.floor(s/(1e3/60)),l=p/a,c=0,this.isScrollTo=!0,d(function o(){c<a?(c===a-1?i.scrollTop=r:i.scrollTop-=l,c+=1,d(o)):(i.scrollTop=r,n.isScrollTo=!1)})):i.scrollTop=r}},{key:"on",value:function(o,t){o&&"function"==typeof t&&(this.events[o]=t)}},{key:"hook",value:function(o,t){o&&"function"==typeof t&&(this.hooks[o]=t)}}]),y);function y(o){!function(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),this.contentWrap=o.contentWrap,this.scrollWrap=o.scrollWrap,this.options=o.options,this.os=o.os,this.events={},this.hooks={},this.isScrollTo=!1,this.upLoading=!1,this.downLoading=!1,this.isFinishUp=!1,this._init()}function W(o,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}var T={down:{isLock:!1,isAuto:!1,isAllowAutoLoading:!0,isAways:!1,isScrollCssTranslate:!0,isAutoResetUpLoading:!0,offset:75,dampRateBegin:1,dampRate:.3,bounceTime:300,successAnim:{isEnable:!1,duration:300},onPull:null,onCalcel:null,callback:o},up:{isLock:!1,isAuto:!0,isShowUpLoading:!0,offset:100,loadFull:{isEnable:!0,delay:300},onScroll:null,callback:o},container:"#minirefresh",isLockX:!0,isScrollBar:!0,isUseBodyScroll:!1},_="minirefresh-hide-scrollbar",b=(function(o,t,n){return t&&W(o.prototype,t),n&&W(o,n),o}(H,[{key:"_initEvent",value:function(){var n=this,i=this.options;this.scroller.on("initScroll",function(){n._initScrollHook&&n._initScrollHook()}),this.scroller.on("downLoading",function(o){!o&&n._downLoaingHook&&n._downLoaingHook(),i.down.callback&&i.down.callback()}),this.scroller.on("cancelLoading",function(){n._cancelLoaingHook&&n._cancelLoaingHook(),i.down.onCalcel&&i.down.onCalcel()}),this.scroller.on("pull",function(o,t){n._pullHook&&n._pullHook(o,t),i.down.onPull&&i.down.onPull()}),this.scroller.on("upLoading",function(){n._upLoaingHook&&n._upLoaingHook(n.options.up.isShowUpLoading),i.up.callback&&i.up.callback()}),this.scroller.on("resetUpLoading",function(){n._resetUpLoadingHook&&n._resetUpLoadingHook()}),this.scroller.on("scroll",function(o){n._scrollHook&&n._scrollHook(o),i.up.onScroll&&i.up.onScroll(o)}),this.scroller.hook("beforeDownLoading",function(o,t){return!n._beforeDownLoadingHook||n._beforeDownLoadingHook(o,t)})}},{key:"_endDownLoading",value:function(o,t){var n,i,s=this;this.options.down&&this.scroller.downLoading&&(n=this.options.down.successAnim.isEnable,i=this.options.down.successAnim.duration,n?this._downLoaingSuccessHook&&this._downLoaingSuccessHook(o,t):i=0,setTimeout(function(){s.scroller.endDownLoading(),setTimeout(function(){s._downLoaingEndHook&&s._downLoaingEndHook(o)},300)},i))}},{key:"_lockUpLoading",value:function(o){this.options.up.isLock=o,this._lockUpLoadingHook&&this._lockUpLoadingHook(o)}},{key:"_lockDownLoading",value:function(o){this.options.down.isLock=o,this._lockDownLoadingHook&&this._lockDownLoadingHook(o)}},{key:"refreshOptions",value:function(o){this.options=h(!0,{},this.options,o),this.scroller.refreshOptions(this.options),this._lockUpLoading(this.options.up.isLock),this._lockDownLoading(this.options.down.isLock),this._refreshHook&&this._refreshHook()}},{key:"endDownLoading",value:function(o,t){var n=!(0<arguments.length&&void 0!==o)||o;this._endDownLoading(n,t),this.options.down.isAutoResetUpLoading&&this.resetUpLoading()}},{key:"resetUpLoading",value:function(){this.scroller.resetUpLoading()}},{key:"endUpLoading",value:function(o){this.scroller.upLoading&&(this.scroller.endUpLoading(o),this._upLoaingEndHook&&this._upLoaingEndHook(o))}},{key:"triggerUpLoading",value:function(){this.scroller.triggerUpLoading()}},{key:"triggerDownLoading",value:function(o){this.scroller.scrollTo(0),this.scroller.triggerDownLoading(o)}},{key:"scrollTo",value:function(o,t){this.scroller.scrollTo(o,t)}},{key:"getPosition",value:function(){return this.scrollWrap.scrollTop}}]),H);function H(o){!function(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}(this,H),function(o){this.os={};var t=o.match(/(Android);?[\s/]+([\d.]+)?/);t&&(this.os.android=!0,this.os.version=t[2],this.os.isBadAndroid=!/Chrome\/\d/.test(window.navigator.appVersion));var n=o.match(/(iPhone\sOS)\s([\d_]+)/);n&&(this.os.ios=!0,this.os.iphone=!0,this.os.version=n[2].replace(/_/g,"."));var i=o.match(/(iPad).*OS\s([\d_]+)/);i&&(this.os.ios=!0,this.os.ipad=!0,this.os.version=i[2].replace(/_/g,"."));var s=o.match(/QuickHybrid/i);s&&(this.os.quick=!0);var e=o.match(/EpointEJS/i);e&&(this.os.ejs=!0);var r=o.match(/DingTalk/i);r&&(this.os.dd=!0),e||r||s||(this.os.h5=!0)}.call(this,navigator.userAgent),this.options=h(!0,{},T,o),this.container=n(this.options.container),this.contentWrap=this.container.children[0],this.scrollWrap=this.options.isUseBodyScroll?document.body:this.container,this.options.isScrollBar||this.container.classList.add(_),this._initHook&&this._initHook(this.options.down.isLock,this.options.up.isLock),this.scroller=new m(this),this._initEvent(),this.options.up.isLock&&this._lockUpLoading(this.options.up.isLock),this.options.down.isLock&&this._lockDownLoading(this.options.down.isLock)}var S={};return Object.keys(e).forEach(function(o){S[o]=e[o]}),S.namespace=function(o,t){s(S,o,t)},S.Core=b,S.version="2.0.0",window.MiniRefreshTools=S}),function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):o.MiniRefresh=t()}(this,function(){"use strict";var o=function(o,t,n){return t&&i(o.prototype,t),n&&i(o,n),o};function i(o,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}var t=MiniRefreshTools.Core,n=MiniRefreshTools.version,s=MiniRefreshTools.extend,e=MiniRefreshTools.namespace,r="minirefresh-theme-default",a="minirefresh-fade-in",l="minirefresh-fade-out",c="minirefresh-rotate",p="minirefresh-hardware-speedup",h="minirefresh-hidden",u="body-scroll-wrap",d="downwrap-success",w="downwrap-error",f="status-default",g="status-pull",v="status-loading",L="status-success",k="status-error",m="status-nomore",y={down:{successAnim:{isEnable:!1,duration:300},contentdown:"下拉刷新",contentover:"释放刷新",contentrefresh:"加载中...",contentsuccess:"刷新成功",contenterror:"刷新失败",isWrapCssTranslate:!1},up:{toTop:{isEnable:!0,duration:300,offset:800},contentdown:"",contentrefresh:"加载中...",contentnomore:"没有更多数据了"}},W=(function(o,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);o.prototype=Object.create(t&&t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(o,t):o.__proto__=t)}(T,t),o(T,[{key:"_initHook",value:function(){var o=this.container,t=this.contentWrap;o.classList.add(r),t.classList.add(p),this.options.isUseBodyScroll&&(o.classList.add(u),t.classList.add(u)),this._initDownWrap(),this._initUpWrap(),this._initToTop()}},{key:"_refreshHook",value:function(){this.options.down.isWrapCssTranslate?this._transformDownWrap(-this.downWrapHeight):this._transformDownWrap(0,0,!0),this.options.up.toTop.isEnable||(this.toTopBtn&&this.toTopBtn.classList.add(h),this.isShowToTopBtn=!1)}},{key:"_initDownWrap",value:function(){var o=this.container,t=this.contentWrap,n=this.options,i=document.createElement("div");i.className="minirefresh-downwrap "+p,i.innerHTML=' \n            <div class="downwrap-content">\n                <p class="downwrap-progress"></p>\n                <p class="downwrap-tips">'+n.down.contentdown+"</p>\n            </div>\n        ",i.style.visibility="hidden",o.insertBefore(i,t),this.downWrap=i,this.downWrapProgress=this.downWrap.querySelector(".downwrap-progress"),this.downWrapTips=this.downWrap.querySelector(".downwrap-tips"),this.isCanPullDown=!1,this.downWrapHeight=i.offsetHeight||75,this._transformDownWrap(-this.downWrapHeight),T._changeWrapStatusClass(this.downWrap,f)}},{key:"_transformDownWrap",value:function(o,t,n){var i,s,e=0<arguments.length&&void 0!==o?o:0,r=1<arguments.length&&void 0!==t?t:0;(n||this.options.down.isWrapCssTranslate)&&(i=r+"ms",s="translateY("+e+"px)  translateZ(0px)",this.downWrap.style.webkitTransitionDuration=i,this.downWrap.style.transitionDuration=i,this.downWrap.style.webkitTransform=s,this.downWrap.style.transform=s)}},{key:"_initUpWrap",value:function(){var o=this.contentWrap,t=this.options,n=document.createElement("div");n.className="minirefresh-upwrap "+p,n.innerHTML=' \n            <p class="upwrap-progress"></p>\n            <p class="upwrap-tips">'+t.up.contentdown+"</p>\n        ",n.style.visibility="hidden",o.appendChild(n),this.upWrap=n,this.upWrapProgress=this.upWrap.querySelector(".upwrap-progress"),this.upWrapTips=this.upWrap.querySelector(".upwrap-tips"),T._changeWrapStatusClass(this.upWrap,f)}},{key:"_initToTop",value:function(){var o,t=this,n=this.options,i=n.up.toTop.isEnable,s=n.up.toTop.duration;i&&((o=document.createElement("div")).className="minirefresh-totop "+r,o.onclick=function(){t.scroller.scrollTo(0,s)},o.classList.add(h),this.toTopBtn=o,this.isShowToTopBtn=!1,this.container.appendChild(o))}},{key:"_pullHook",value:function(o,t){var n,i=this.options;o<t?this.isCanPullDown&&(this.isCanPullDown=!1,T._changeWrapStatusClass(this.downWrap,f),this.downWrapTips.innerText=i.down.contentdown):this.isCanPullDown||(this.downWrapTips.innerText=i.down.contentover,this.downWrap.style.visibility="visible",this.isCanPullDown=!0,T._changeWrapStatusClass(this.downWrap,g)),this.downWrapProgress&&(n="rotate("+o/t*360+"deg)",this.downWrapProgress.style.webkitTransform=n,this.downWrapProgress.style.transform=n),this._transformDownWrap(-this.downWrapHeight+o)}},{key:"_scrollHook",value:function(o){var t=this.options,n=t.up.toTop.isEnable,i=this.toTopBtn;n&&i&&(o>=t.up.toTop.offset?this.isShowToTopBtn||(i.classList.remove(l),i.classList.remove(h),i.classList.add(a),this.isShowToTopBtn=!0):this.isShowToTopBtn&&(i.classList.add(l),i.classList.remove(a),this.isShowToTopBtn=!1))}},{key:"_downLoaingHook",value:function(){this._transformDownWrap(-this.downWrapHeight+this.options.down.offset,this.options.down.bounceTime),this.downWrapTips.innerText=this.options.down.contentrefresh,this.downWrapProgress.classList.add(c),this.downWrap.style.visibility="visible",T._changeWrapStatusClass(this.downWrap,v)}},{key:"_downLoaingSuccessHook",value:function(o,t){this.options.down.contentsuccess=t||this.options.down.contentsuccess,this.downWrapTips.innerText=o?this.options.down.contentsuccess:this.options.down.contenterror,this.downWrapProgress.classList.remove(c),this.downWrapProgress.classList.add(l),this.downWrapProgress.classList.add(o?d:w),this.downWrap.style.visibility="visible",T._changeWrapStatusClass(this.downWrap,o?L:k)}},{key:"_downLoaingEndHook",value:function(o){this.downWrapTips.innerText=this.options.down.contentdown,this.downWrapProgress.classList.remove(c),this.downWrapProgress.classList.remove(l),this.downWrap.style.visibility="hidden",this.downWrapProgress.classList.remove(o?d:w),this.isCanPullDown=!1,this._transformDownWrap(-this.downWrapHeight,this.options.down.bounceTime),T._changeWrapStatusClass(this.downWrap,f)}},{key:"_cancelLoaingHook",value:function(){this._transformDownWrap(-this.downWrapHeight,this.options.down.bounceTime),T._changeWrapStatusClass(this.downWrap,f)}},{key:"_upLoaingHook",value:function(o){o?(this.upWrapTips.innerText=this.options.up.contentrefresh,this.upWrapProgress.classList.add(c),this.upWrapProgress.classList.remove(h),this.upWrap.style.visibility="visible"):this.upWrap.style.visibility="hidden",T._changeWrapStatusClass(this.upWrap,v)}},{key:"_upLoaingEndHook",value:function(o){o?(this.upWrapTips.innerText=this.options.up.contentnomore,T._changeWrapStatusClass(this.upWrap,m)):(this.upWrapTips.innerText=this.options.up.contentdown,T._changeWrapStatusClass(this.upWrap,f)),this.upWrapProgress.classList.remove(c),this.upWrapProgress.classList.add(h)}},{key:"_resetUpLoadingHook",value:function(){this.upWrapTips.innerText=this.options.up.contentdown,this.upWrapProgress.classList.remove(c),this.upWrapProgress.classList.add(h),T._changeWrapStatusClass(this.upWrap,f)}},{key:"_lockUpLoadingHook",value:function(o){this.upWrap.style.visibility=o?"hidden":"visible"}},{key:"_lockDownLoadingHook",value:function(o){this.downWrap.style.visibility=o?"hidden":"visible"}}],[{key:"_changeWrapStatusClass",value:function(o,t){o.classList.remove(m),o.classList.remove(f),o.classList.remove(g),o.classList.remove(v),o.classList.remove(L),o.classList.remove(k),o.classList.add(t)}}]),T);function T(o){!function(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}(this,T);var t=s(!0,{},y,o);return function(o,t){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?o:t}(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,t))}return W.sign="default",W.version=n,e("theme.defaults",W),window.MiniRefresh=W});