!function(){"use strict";var t={container:"#gallery",isAutoProxy:void 0,isLoop:!0,isAuto:!1,autoTime:3e3,perLineItem:2,maxImgHeight:"100%",minImgHeight:null,isShowIndicator:!0,isShowPageIndicator:!1};function i(i){i=Util.extend({},t,i),this.container=Util.selector(i.container),this._initData(i)}i.prototype={_initData:function(i){if(i.data=i.data||[],this.options=i,!this._validate())throw new Error("验证错误，图片轮播的传入格式非法，请检查代码");this._render(),this._addEvent(),this._dealUrl()},_dealUrl:function(){var i,e=this,r=this.options;r.url&&(r.success=function(i){var t=r.dataChange?r.dataChange(i):Util.dataProcess(i,{dataPath:"custom.gallery"}).data;t&&(r.data=t,e._render(),e._addEvent())},(i=Util.extend({},r)).data=i.dataRequest,Util.ajax(i))},_validate:function(){var i=this.options.data,t=!0;return this.container&&i&&Array.isArray(i)||(t=!1),t},_render:function(){this.options.data=function i(t){if(!t)throw new Error("错误，数据为空！");var e=t.length,r=[];for(var a=0;a<e;a++){var n=t[a];Array.isArray(n)?r[a]=i(n):r[a]={id:n.guid||n.id,title:n.title,url:n.pic||n.url}}return r}(this.options.data);var i=this.container,t=this._renderGenHtml(),e=Util.parseHtml(t);i.innerHTML="",e&&i.appendChild(e)},_renderGenHtml:function(){function i(i,t){var e="";e+=t?'<div class="mui-slider-item mui-slider-item-duplicate" >':'<div class="mui-slider-item">';var r=i.id?"id="+i.id:"",a=o.maxImgHeight?"max-height:"+o.maxImgHeight+";":"",n=o.minImgHeight?"min-height:"+o.minImgHeight+";":"";return e+='<a class="slider-img-item"'+r+">",e+='<img src="'+i.url+'" style="'+a+n+'">',i.title&&(e+='<p class="mui-slider-title">'+i.title+"</p>"),e+="</a>",e+="</div>"}function t(i,t){var e="";e+=t?'<div class="mui-slider-item mui-slider-item-duplicate" >':'<div class="mui-slider-item">',e+='<ul class="mui-table-view mui-grid-view">';for(var r=i.length,a="mui-col-xs-"+12/o.perLineItem,n=0;n<r;n++){var s=i[n].id?"id="+i[n].id:"",l=o.maxImgHeight?"max-height:"+o.maxImgHeight+";":"",d=o.minImgHeight?"min-height:"+o.minImgHeight+";":"";e+=' <li class="mui-table-view-cell mui-media slider-img-item '+a+'" '+s+">",e+="<a> ",e+='<img class="mui-media-object" src="'+i[n].url+'" style="'+l+d+'">',i[n].title&&(e+='<div class="mui-media-body">'+i[n].title+"</div>"),e+="</a>",e+="</li>"}return e+="</ul>",e+="</div>"}var e,o=this.options,r=o.data,a=r.length,n="";n+='<div class="mui-slider">',o.isLoop?n+='<div class="mui-slider-group mui-slider-loop">':n+='<div class="mui-slider-group">',o.isLoop&&(e=a-1,Array.isArray(r[e])?n+=t(r[e],!0):r[e]&&(n+=i(r[e],!0)));for(var s=0;s<a;s++)Array.isArray(r[s])?n+=t(r[s],!1):r[e]&&(n+=i(r[s],!1));if(o.isLoop&&(Array.isArray(r[0])?n+=t(r[0],!0):r[0]&&(n+=i(r[0],!0))),n+="</div>",o.isShowIndicator){n+='<div class="mui-slider-indicator">';for(var l=0;l<a;l++)n+=0===l?'<div class="mui-indicator mui-active"></div>':'<div class = "mui-indicator"></div>';n+="</div>"}return o.isShowPageIndicator&&(n+='<div class="mui-slider-indicator">',n+='<span class="mui-action mui-action-previous mui-icon mui-icon-back"></span>',n+='<div class="mui-number">',n+='<span id="curr-gallery-index">1</span> / <span id="gallery-length">'+a+"</span>",n+="</div>",n+='<span class="mui-action mui-action-next mui-icon mui-icon-forward"></span>',n+="</div>"),n+="</div>"},_addEvent:function(){var i=this.container,t=this.options,e=t.itemClick,r=mui(i),a=t.autoTime;t.isAuto||(a=0),r.slider({interval:a}),mui(i).off(),mui(i).on("tap",".slider-img-item",function(i){var t=this.getAttribute("id");return i.preventDefault(),e&&e(i,t),!1}),t.isShowIndicator&&mui(i).on("tap",".mui-slider-indicator .mui-indicator",function(i){var t=[].indexOf.call(this.parentNode.childNodes,this);return r.slider().gotoItem(t),i.preventDefault(),!1}),t.isShowPageIndicator&&(mui(i).on("tap",".mui-slider-indicator .mui-action-previous",function(i){return r.slider().prevItem(),i.preventDefault(),!1}),mui(i).on("tap",".mui-slider-indicator .mui-action-next",function(i){return r.slider().nextItem(),i.preventDefault(),!1})),this.gallery=r},update:function(i){i=Util.extend({},this.options,i),this._initData(i)},gotoItem:function(i,t){this.gallery&&this.gallery.slider().gotoItem(i,t)},nextItem:function(){this.gallery&&this.gallery.slider().nextItem()},prevItem:function(){this.gallery&&this.gallery.slider().prevItem()},getSlideNumber:function(){return this.gallery&&this.gallery.slider().getSlideNumber()},destroy:function(){return this.gallery&&this.gallery.slider().destroy(),mui(this.container).off(),null}},window.Gallery=i}();